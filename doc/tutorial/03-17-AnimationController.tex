p\subsection{アニメーションコントローラー}

AnimationContollerはアニメーションの再生スピードなどを制御します。
アニメーショントラックは必ずアニメーションコントローラーに結びつけられている必要があります。


\begin{verbatim}
AnimationController* ctlr = new AnimationController;
track->setAnimationController (ctlr);
\end{verbatim}

\subsubsection{アクティブ期間}

このアニメーションが有効な期間をsetActiveInterval()メソッドで指定します。

\begin{verbatim}
void 	setActiveInterval (int start, int end)
\end{verbatim}

このコントローラーがアクティブな期間をワールド時間(start,end]で指定します。
startは含み、endは含みません。
このコントローラーに関連づけられたアニメーショントラックは、
この期間以外は再生されません。
start=endは特別な値で、指定すると全ての時刻で有効と見なされます。

現在のアクティブ期間はgetActiveIntervalStart()メソッドとgetActiveIntervalEnd()メソッドで取得できます。

\begin{verbatim}
int 	getActiveIntervalStart () const
int 	getActiveIntervalEnd () const
\end{verbatim}

ある時刻(t=world\_time)でアクティブかどうかはisActiveInterval()メソッドで取得できます。
この関数はM3G非標準です。

\begin{verbatim}
bool 	isActiveInterval (int world_time) const 
\end{verbatim}

\subsubsection{再生速度}

速度はこのコントローラーに関連づけられたアニメーショントラックの再生速度を変更します。
再生速度はsetSpeed()メソッドで変更します。

\begin{verbatim}
void 	setSpeed (float speed, int world_time)
\end{verbatim}

1番目の引数のspeedは再生速度です。
デフォルトはspeed=1.0で、例えば2.0に設定すると
アニメーションターゲットは2倍速で再生されます。
2番目の引数のworld\_timeは現在のワールド時間を指定します。
内部的にアニメーションを連続して再生するのに必要です。

現在の再生速度はgetSpeed()メソッドで取得できます。

\begin{verbatim}
float 	getSpeed () const
\end{verbatim}

\subsubsection{アニメーションウェイト}
setWeight()メソッドでこのコントローラーのウェイトを設定します。
ウェイトは２つのアニメーションをブレンドし、なめらかに遷移するのに使用されます。

\begin{verbatim}
void 	setWeight (float weight)
\end{verbatim}

引数のweightは0以上の浮動小数値を指定します。

現在のウェイト値はgetWeight()メソッドで取得します。

\begin{verbatim}
float 	getWeight () const
\end{verbatim}


\subsubsection{リファレンス時刻の設定}

リファレンスとなるシーケンス時間をsetPosition()メソッドを使って設定します。

\begin{verbatim}
void 	setPosition (float sequence_time, int world_time)
\end{verbatim}

第2引数には現在のworld\_timeを指定します。これは内部的にアニメーションを連続して再生ために必要です。

現在の再生位置はgetPosition()メソッドで取得できます。

\begin{verbatim}
float 	getPosition (int world_time) const
\end{verbatim}

現在のリファレンスのワールド時間はgetRefWorldTime()メソッドで取得できます。

\begin{verbatim}
int 	getRefWorldTime () const
\end{verbatim}


